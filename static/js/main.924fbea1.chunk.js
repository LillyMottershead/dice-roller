(this.webpackJsonpquickroll=this.webpackJsonpquickroll||[]).push([[0],{18:function(t,e,n){},19:function(t,e,n){},21:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),c=n(12),o=n.n(c),l=(n(18),n(2)),s=n(13),i=n(3),u=n(7),m=n(8),d=n(11),f=n(10),h=(n(19),n(9)),p=function(t,e){return t+e},j=/^(\d+)?d(\d+)(?:k([l-])?(\d+))?$/,g=/\s+/,b=/^(?:(?:(?:\d+)?d\d+(?:k(?:[l-])?\d+)?)|[+\-*/()]|\d+|\s+)+$/,v=/((?:\d+)?d\d+(?:k(?:[l-])?\d+)?)|([+\-*/()])|(\d+)/g,O=/\[(.*?)\]/g,x=/\{(.*?)\}/g,y=/(?:(\w+)(?:\((.*?)\))?)/g,S={add:function(t,e){var n,a=e.match(v);"+-*/".includes(a[0])||t.tokens.push("+");(n=t.tokens).push.apply(n,Object(l.a)(a))},replace:N,adv:function(t){return N(t,"d20","2d20k1")},dis:function(t){return N(t,"d20","2d20kl1")},max:function(t){return t.max=!0},tohit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;t.tohit=!0,t.minToCrit=e},cancrit:function(t){return t.cancrit=!0},crit:function(t){return t.crit=!0}};function C(t){this.name="RollError",this.message=t,this.stack=(new Error).stack}function k(t){return null!==t.match(j)}function w(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.match(j);if(!n)throw new C("Cannot parse ".concat(t," as a valid roll."));var a=+n[2],r=+n[1]||1,c=+n[4]||0,o=!n[3];if(a<2)throw new C("Less than 2 sides in ".concat(t));if(r<1)throw new C("Rolling less than 1 time in ".concat(t));if(c<0)throw new C("Cannot keep less 1 die in ".concat(t));if(c>r)throw new C("Cannot keep more die than are rolled in ".concat(t));for(var l=c?"k".concat(o?"":"l").concat(c):"",s="".concat(r,"d").concat(a).concat(l),i=[],u=0;u<r;u++)i.push({sides:a,num:e?a:Math.ceil(Math.random()*a),kept:!0});if(c<r){var m=[].concat(i);m.sort((function(t,e){return t.num-e.num})),o||m.reverse(),m.slice(0,c).forEach((function(t){return t.kept=!1}))}var d=i.filter((function(t){return t.kept})).map((function(t){return t.num})),f=d.reduce(p);return{sides:a,result:f,rolls:i,desc:"".concat(s," (").concat(i.map((function(t){return t.num})).join(", "),")")}}function N(t,e,n){-1!==t.tokens.indexOf(e)&&(t.tokens[t.tokens.indexOf(e)]=n)}function R(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"addmaxdice",r={crit:n};r.label=Array.from(t.matchAll(O),(function(t){return t[1]}))[0]||"",t=t.replaceAll(O,"");var c=Array.from(t.matchAll(y));if((c=c.filter((function(t){return!t[0].match(b)}))).reverse(),c.forEach((function(e){t="".concat(t.slice(0,e.index)).concat(t.slice(e.index+e[0].length))})),c.reverse(),c=c.map((function(t){var e={name:t[1]};return e.params=t[2]?t[2].split(/\s*,\s*/):[],e})),!t.match(b))throw new C("Unknown command.");r.tokens=t.match(v);var o,s=Object(h.a)(c);try{for(s.s();!(o=s.n()).done;){var i=o.value;S[i.name]&&S[i.name].apply(S,[r].concat(Object(l.a)(i.params)))}}catch(j){s.e(j)}finally{s.f()}var u=r.tokens.map((function(t){return k(t)?w(t,r.max||!1):t}));r.dice=u.filter((function(t){return void 0!==t.desc})),r.dice=(e=[]).concat.apply(e,Object(l.a)(r.dice.map((function(t){return t.rolls})))),r.desc=u.map((function(t){return t.desc||t})).join(" ");var m=u.map((function(t){return t.result||t})).join(" ");if(r.result=Function("return ".concat(m,";"))(),r.tohit&&(r.crit=u.find((function(t){return 20===t.sides})).result>=r.minToCrit||r.crit),r.crit&&r.cancrit){var d=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=r.tokens.filter((function(t){return k(t)}));e=e.map((function(e){return w(e,t)})),r.critDesc=e.map((function(t){return t.desc})).join(" + "),r.critResult=e.map((function(t){return t.result})).reduce(p)};if("rolldouble"===a)d();else if("doubledice"===a){var f=u.filter((function(t){return"object"===typeof t}));r.critDesc=f.map((function(t){return t.desc})).join(" + "),r.critResult=f.map((function(t){return t.result})).reduce(p)}else"addmaxdice"===a&&d(!0);r.fullString="".concat(r.desc," = ").concat(r.result),r.critString="CRIT: ".concat(r.critDesc," = ").concat(r.critResult)}else r.fullString="".concat(r.desc," = ").concat(r.result);return r}function A(t,e){var n=Array.from(e.matchAll(y));n=n.map((function(t){var e={name:t[1]};return e.params=t[2]?t[2].split(/\s*,\s*/):[],e}));var a,r=Object(h.a)(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;if("attack"===c.name){t[0]=t[0].concat(" tohit");var o=c.params;0===o.length&&(o=Object(l.a)(new Array(t.length).keys()).slice(1)),o.forEach((function(e){return t[e]=t[e].concat(" cancrit")}))}else{if(!Object.keys(S).includes(c.name))throw new C("Unrecognized argument ".concat(c.name));var s=S[c.name],i=void 0;c.params.length===s.length-1?i=0:(i=+c.params[c.params.length-1]-1,c.params=c.params.slice(0,c.params.length)),c="".concat(c.name,"(").concat(c.params.join(","),")"),t[i]=t[i].concat(" ",c)}}}catch(u){r.e(u)}finally{r.f()}}function F(t){var e=JSON.parse(localStorage.aliases);if(t.length<1)throw new C("Missing target alias to delete.");var n=t[0];if(!e[n])throw new C("Alias ".concat(n," does not exist."));return delete e[n],localStorage.setItem("aliases",JSON.stringify(e)),{message:"Removed ".concat(n," from list of aliases."),alias:n}}C.prototype=new Error;var I=function(t){if(""===t)throw new C("Empty command.");var e=t.split(g),n=e[0];return e=e.slice(1),"alias"===n?function(t){var e=JSON.parse(localStorage.aliases);function n(){var t=JSON.parse(localStorage.aliases);return 0===Object.keys(t).length?{message:"No aliases."}:{message:"Aliases: ".concat(Object.keys(t).join(", "))}}if(t.length<1)return n();var a=t[0];if(t=t.slice(1),"delete"===a)return F(t);if("list"===a)return n();if(t.length<1){if(!e[a])throw new C("Alias ".concat(a," does not exist."));return{message:"".concat(a,": ").concat(e[a].rolls.join(", "))}}var r=t.join(" ");return e[a]={rolls:Array.from(r.matchAll(x),(function(t){return t[1]}))},r=r.replaceAll(x,""),A(e[a].rolls,r),localStorage.setItem("aliases",JSON.stringify(e)),{message:"Added ".concat(a," to aliases."),alias:a}}(e):"delete"===n?F(e):JSON.parse(localStorage.aliases)[n]?function(t,e){var n=JSON.parse(localStorage.aliases)[t].rolls;A(n=n.concat(Array.from(e.matchAll(x),(function(t){return t[1]}))),e);var a=!1;return n=n.map((function(t){var e=R(t,a);return a=e.crit||a,e})),{message:"Calling ".concat(t,":"),rolls:n}}(n,Array.from(e).join(" ")):{message:"Rolling ".concat(t,":"),rolls:[R(t)]}},J=n(0),L=function(t){Object(d.a)(n,t);var e=Object(f.a)(n);function n(t){var a;return Object(u.a)(this,n),a=e.call(this,t),localStorage.aliases||localStorage.setItem("aliases",JSON.stringify({})),a}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("section",{children:[Object(J.jsx)("h1",{children:"quickroll"}),Object(J.jsx)(E,{})]})}}]),n}(r.a.Component),E=function(t){Object(d.a)(n,t);var e=Object(f.a)(n);function n(t){var a;return Object(u.a)(this,n),(a=e.call(this,t)).onRollFormChange=function(t){var e=t.target,n=e.value,r=e.name;a.setState(Object(s.a)({},r,n))},a.onLogClear=function(t){t.preventDefault(),a.setState({log:{components:[],currKey:0}})},a.onSubmit=function(t){if(t.preventDefault(),"clear"===a.state.rollCommand)a.onLogClear(t),a.setState({rollCommand:"",times:"",output:""});else if(""!==a.state.rollCommand){var e=+a.state.times||1,n=Object(l.a)(new Array(e).keys()).map((function(t,e){return function(t,e,n){function a(t,e){t.components.length>100&&t.components.pop(),t.components.unshift(Object(J.jsx)("p",{children:e},"log#".concat(t.currKey++))),t.currKey%=101}var r;try{r=I(t),a(n,r.message),r.rolls?(r.rolls.forEach((function(t){t.critString?a(n,"".concat(t.fullString,", ").concat(t.critString,", ").concat(t.result," ").concat(t.label)):a(n,"".concat(t.fullString," ").concat(t.label))})),r=r.rolls.map((function(t,e){return Object(J.jsx)(q,{roll:t},"roll#".concat(e))}))):r=Object(J.jsx)("div",{className:"flex-child",children:r.message})}catch(c){a(n,c.message),r=c.message}return Object(J.jsx)(T,{rolls:r},"call#".concat(e))}(a.state.rollCommand,e,a.state.log)}));a.setState({rollCommand:"",times:"",output:n,aliases:JSON.parse(localStorage.aliases||"{}")})}a.textInputRef.current.focus()},a.state={rollCommand:"",times:"",output:"",aliases:JSON.parse(localStorage.aliases||"{}"),log:{components:[],currKey:0}},a.textInputRef=r.a.createRef(),a.onSubmit=a.onSubmit.bind(Object(i.a)(a)),a.onRollFormChange=a.onRollFormChange.bind(Object(i.a)(a)),a.onLogClear=a.onLogClear.bind(Object(i.a)(a)),a}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("section",{children:[Object(J.jsx)(D,{rollCommand:this.state.rollCommand,times:this.state.times,onRollFormChange:this.onRollFormChange,onSubmit:this.onSubmit,textInputRef:this.textInputRef}),Object(J.jsx)("section",{className:"h-container",children:this.state.output}),Object(J.jsxs)("section",{className:"h-container",children:[Object(J.jsx)(M,{aliases:this.state.aliases,handleUpload:this.handleUpload}),Object(J.jsx)(U,{log:this.state.log.components,onLogClear:this.onLogClear})]})]})}}]),n}(r.a.Component);function D(t){return Object(J.jsxs)("form",{children:[Object(J.jsx)("input",{className:"input-text",type:"text",ref:t.textInputRef,autoFocus:!0,name:"rollCommand",value:t.rollCommand,onChange:t.onRollFormChange}),Object(J.jsx)("input",{className:"input-text",type:"text",style:{width:"30px"},name:"times",value:t.times,onChange:t.onRollFormChange}),Object(J.jsx)("input",{className:"input",type:"submit",value:">",onClick:t.onSubmit})]})}function T(t){return Object(J.jsx)("section",{className:"h-container flex-child",style:{border:"none",margin:"10px",maxWidth:"30%"},children:t.rolls})}function q(t){var e=t.roll.result+(t.roll.critResult||0),n=t.roll.label||"",a=t.roll.fullString||"",r=t.roll.critString||"",c=t.roll.dice.map((function(t,e){return Object(J.jsx)(K,{die:t},"rollImage#".concat(e,"}"))}));return Object(J.jsxs)("div",{className:"flex-child tooltip",style:{margin:"-1px",marginBottom:"0px"},children:[c,Object(J.jsxs)("p",{children:[e,Object(J.jsxs)("span",{style:{fontSize:".75em"},children:[" ",n]})]}),Object(J.jsxs)("span",{className:"tooltiptext",children:[a,Object(J.jsx)("br",{}),r]})]})}function K(t){var e="/quick-dice",n=t.die.kept?"dice/":"gray_dice/",a=t.die.sides,r=t.die.num;return e="".concat(e,"/").concat(n,"d").concat(a,"_").concat(r,".svg"),Object(J.jsx)("img",{src:e,alt:"".concat(r," (d").concat(a,")"),height:"50px"})}function M(t){var e=Object.keys(t.aliases);return e.sort(),e=e.map((function(t,e){return Object(J.jsx)("p",{children:t},"alias#".concat(e))})),Object(J.jsxs)("div",{className:"flex-child aliases",children:[Object(J.jsx)("form",{style:{padding:"5px"},children:Object(J.jsx)("label",{className:"h2",children:"Aliases"})}),Object(J.jsx)("div",{children:e})]})}function U(t){return Object(J.jsxs)("div",{className:"flex-child log",children:[Object(J.jsxs)("label",{className:"h2",children:["Log",Object(J.jsx)("button",{className:"input",onClick:t.onLogClear,children:"Clear"})]}),Object(J.jsx)("div",{className:"inner-log",children:t.log})]})}var B=L,z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,22)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),c(t),o(t)}))};o.a.render(Object(J.jsx)(r.a.StrictMode,{children:Object(J.jsx)(B,{})}),document.getElementById("root")),z()}},[[21,1,2]]]);
//# sourceMappingURL=main.924fbea1.chunk.js.map