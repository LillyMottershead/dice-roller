(this.webpackJsonpquickroll=this.webpackJsonpquickroll||[]).push([[0],{18:function(t,e,n){},19:function(t,e,n){},21:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),c=n(12),o=n.n(c),s=(n(18),n(6)),i=n(13),l=n(7),u=n(2),m=n(3),p=n(5),f=n(4),d=(n(19),n(11)),h=function(t,e){return t+e},j=/^(\d+)?d(\d+)(?:k([l-])?(\d+))?$/,g=/\s+/,b=/^(?:(?:(?:\d+)?d\d+(?:k(?:[l-])?\d+)?)|[+\-*/()]|\d+|\s+)+$/,O=/((?:\d+)?d\d+(?:k(?:[l-])?\d+)?)|([+\-*/()])|(\d+)/g,v=/\[(.*?)\]/g,x=/\{(.*?)\}/g,y=/(?:(\w+)(?:\((.*?)\))?)/g,C={add:function(t,e){var n,a=e.match(O);"+-*/".includes(a[0])||t.tokens.push("+");(n=t.tokens).push.apply(n,Object(s.a)(a))},replace:N,adv:function(t){return N(t,"d20","2d20k1")},dis:function(t){return N(t,"d20","2d20kl1")},max:function(t){return t.max=!0},tohit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;t.tohit=!0,t.minToCrit=e},cancrit:function(t){return t.cancrit=!0},crit:function(t){return t.crit=!0}};function S(t){this.name="RollError",this.message=t,this.stack=(new Error).stack}function k(t){return null!==t.match(j)}function w(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.match(j);if(!n)throw new S("Cannot parse ".concat(t," as a valid roll."));var a=+n[2],r=+n[1]||1,c=+n[4]||0,o=!n[3];if(a<2)throw new S("Less than 2 sides in ".concat(t));if(r<1)throw new S("Rolling less than 1 time in ".concat(t));if(c<0)throw new S("Cannot keep less 1 die in ".concat(t));if(c>r)throw new S("Cannot keep more die than are rolled in ".concat(t));for(var s=c?"k".concat(o?"":"l").concat(c):"",i="".concat(r,"d").concat(a).concat(s),l=[],u=0;u<r;u++)l.push({sides:a,num:e?a:Math.ceil(Math.random()*a),kept:!0});if(c<r){var m=[].concat(l);m.sort((function(t,e){return t.num-e.num})),o||m.reverse(),m.slice(0,c).forEach((function(t){return t.kept=!1}))}var p=l.filter((function(t){return t.kept})).map((function(t){return t.num})),f=p.reduce(h);return{sides:a,result:f,rolls:l,desc:"".concat(i," (").concat(l.map((function(t){return t.num})).join(", "),")")}}function N(t,e,n){-1!==t.tokens.indexOf(e)&&(t.tokens[t.tokens.indexOf(e)]=n)}function R(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"addmaxdice",r={crit:n};r.label=Array.from(t.matchAll(v),(function(t){return t[1]}))[0]||"",t=t.replaceAll(v,"");var c=Array.from(t.matchAll(y));if((c=c.filter((function(t){return!t[0].match(b)}))).reverse(),c.forEach((function(e){t="".concat(t.slice(0,e.index)).concat(t.slice(e.index+e[0].length))})),c.reverse(),c=c.map((function(t){var e={name:t[1]};return e.params=t[2]?t[2].split(/\s*,\s*/):[],e})),!t.match(b))throw new S("Unknown command.");r.tokens=t.match(O);var o,i=Object(d.a)(c);try{for(i.s();!(o=i.n()).done;){var l=o.value;C[l.name]&&C[l.name].apply(C,[r].concat(Object(s.a)(l.params)))}}catch(j){i.e(j)}finally{i.f()}var u=r.tokens.map((function(t){return k(t)?w(t,r.max||!1):t}));r.dice=u.filter((function(t){return void 0!==t.desc})),r.dice=(e=[]).concat.apply(e,Object(s.a)(r.dice.map((function(t){return t.rolls})))),r.desc=u.map((function(t){return t.desc||t})).join(" ");var m=u.map((function(t){return t.result||t})).join(" ");if(r.result=Function("return ".concat(m,";"))(),r.tohit&&(r.crit=u.find((function(t){return 20===t.sides})).result>=r.minToCrit||r.crit),r.crit&&r.cancrit){var p=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=r.tokens.filter((function(t){return k(t)}));e=e.map((function(e){return w(e,t)})),r.critDesc=e.map((function(t){return t.desc})).join(" + "),r.critResult=e.map((function(t){return t.result})).reduce(h)};if("rolldouble"===a)p();else if("doubledice"===a){var f=u.filter((function(t){return"object"===typeof t}));r.critDesc=f.map((function(t){return t.desc})).join(" + "),r.critResult=f.map((function(t){return t.result})).reduce(h)}else"addmaxdice"===a&&p(!0);r.fullString="".concat(r.desc," = ").concat(r.result),r.critString="CRIT: ".concat(r.critDesc," = ").concat(r.critResult)}else r.fullString="".concat(r.desc," = ").concat(r.result);return r}function A(t,e){var n=Array.from(e.matchAll(y));n=n.map((function(t){var e={name:t[1]};return e.params=t[2]?t[2].split(/\s*,\s*/):[],e}));var a,r=Object(d.a)(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;if("attack"===c.name){t[0]=t[0].concat(" tohit");var o=c.params;0===o.length&&(o=Object(s.a)(new Array(t.length).keys()).slice(1)),o.forEach((function(e){return t[e]=t[e].concat(" cancrit")}))}else{if(!Object.keys(C).includes(c.name))throw new S("Unrecognized argument ".concat(c.name));var i=C[c.name],l=void 0;c.params.length===i.length-1?l=0:(l=+c.params[c.params.length-1]-1,c.params=c.params.slice(0,c.params.length)),c="".concat(c.name,"(").concat(c.params.join(","),")"),t[l]=t[l].concat(" ",c)}}}catch(u){r.e(u)}finally{r.f()}}function F(t){var e=JSON.parse(localStorage.aliases);if(t.length<1)throw new S("Missing target alias to delete.");var n=t[0];if(!e[n])throw new S("Alias ".concat(n," does not exist."));return delete e[n],localStorage.setItem("aliases",JSON.stringify(e)),{message:"Removed ".concat(n," from list of aliases."),alias:n}}S.prototype=new Error;var I=function(t){if(""===t)throw new S("Empty command.");var e=t.split(g),n=e[0];return e=e.slice(1),"alias"===n?function(t){var e=JSON.parse(localStorage.aliases);function n(){var t=JSON.parse(localStorage.aliases);return 0===Object.keys(t).length?{message:"No aliases."}:{message:"Aliases: ".concat(Object.keys(t).join(", "))}}if(t.length<1)return n();var a=t[0];if(t=t.slice(1),"delete"===a)return F(t);if("list"===a)return n();if(t.length<1){if(!e[a])throw new S("Alias ".concat(a," does not exist."));return{message:"".concat(a,": ").concat(e[a].rolls.join(", "))}}var r=t.join(" ");return e[a]={rolls:Array.from(r.matchAll(x),(function(t){return t[1]}))},r=r.replaceAll(x,""),A(e[a].rolls,r),localStorage.setItem("aliases",JSON.stringify(e)),{message:"Added ".concat(a," to aliases."),alias:a}}(e):"delete"===n?F(e):JSON.parse(localStorage.aliases)[n]?function(t,e){var n=JSON.parse(localStorage.aliases)[t].rolls;A(n=n.concat(Array.from(e.matchAll(x),(function(t){return t[1]}))),e);var a=!1;return n=n.map((function(t){var e=R(t,a);return a=e.crit||a,e})),{message:"Calling ".concat(t,":"),rolls:n}}(n,Array.from(e).join(" ")):{message:"Rolling ".concat(t,":"),rolls:[R(t)]}},J=n(0),L=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(t){var a;return Object(u.a)(this,n),a=e.call(this,t),localStorage.aliases||localStorage.setItem("aliases",JSON.stringify({})),a}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("section",{children:[Object(J.jsx)("h1",{children:"quickroll"}),Object(J.jsx)(E,{})]})}}]),n}(r.a.Component),E=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(t){var a;return Object(u.a)(this,n),(a=e.call(this,t)).onRollFormChange=function(t){var e=t.target,n=e.value,r=e.name;a.setState(Object(i.a)({},r,n))},a.onLogClear=function(t){t.preventDefault(),a.setState({log:[]})},a.onSubmit=function(t){if(t.preventDefault(),"clear"===a.state.rollCommand)a.onLogClear(t),a.setState({rollCommand:"",times:"",output:""});else if(""!==a.state.rollCommand){var e=+a.state.times||1,n=Object(s.a)(new Array(e).keys()).map((function(t,e){return function(t,e,n){function a(t,e){t.components.length>100&&t.components.pop(),t.components.unshift(Object(J.jsx)("p",{children:e},"log#".concat(t.currKey++))),t.currKey%=101}var r;try{r=I(t),a(n,r.message),r.rolls?(r.rolls.forEach((function(t){t.critString?a(n,"".concat(t.fullString,", ").concat(t.critString,", ").concat(t.result," ").concat(t.label)):a(n,"".concat(t.fullString," ").concat(t.label))})),r=r.rolls.map((function(t,e){return Object(J.jsx)(M,{roll:t},"roll#".concat(e))}))):r=Object(J.jsx)("div",{className:"flex-child",children:r.message})}catch(c){a(n,c.message),r=c.message}return Object(J.jsx)(T,{rolls:r},"call#".concat(e))}(a.state.rollCommand,e,a.state.log)}));a.setState({rollCommand:"",times:"",output:n,aliases:JSON.parse(localStorage.aliases||"{}"),log:a.state.log})}a.textInputRef.current.focus()},localStorage.aliases||localStorage.setItem("aliases",JSON.stringify({})),a.state={rollCommand:"",times:"",output:"",aliases:JSON.parse(localStorage.aliases||"{}"),log:{components:[],currKey:0}},a.textInputRef=r.a.createRef(),a.onSubmit=a.onSubmit.bind(Object(l.a)(a)),a.onRollFormChange=a.onRollFormChange.bind(Object(l.a)(a)),a.onLogClear=a.onLogClear.bind(Object(l.a)(a)),a}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("section",{children:[Object(J.jsx)(D,{rollCommand:this.state.rollCommand,times:this.state.times,onRollFormChange:this.onRollFormChange,onSubmit:this.onSubmit,textInputRef:this.textInputRef}),Object(J.jsx)("section",{className:"h-container",children:this.state.output}),Object(J.jsxs)("section",{className:"h-container",children:[Object(J.jsx)(q,{aliases:this.state.aliases,handleUpload:this.handleUpload}),Object(J.jsx)(B,{log:this.state.log.components,onLogClear:this.onLogClear})]})]})}}]),n}(r.a.Component),D=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("form",{children:[Object(J.jsx)("input",{className:"input-text",type:"text",ref:this.props.textInputRef,autoFocus:!0,name:"rollCommand",value:this.props.rollCommand,onChange:this.props.onRollFormChange}),Object(J.jsx)("input",{className:"input-text",type:"text",style:{width:"30px"},name:"times",value:this.props.times,onChange:this.props.onRollFormChange}),Object(J.jsx)("input",{className:"input",type:"submit",value:">",onClick:this.props.onSubmit})]})}}]),n}(r.a.Component),T=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsx)("section",{className:"h-container flex-child",style:{border:"none",margin:"10px",maxWidth:"30%"},children:this.props.rolls})}}]),n}(r.a.Component),M=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var t=this.props.roll.result+(this.props.roll.critResult||0),e=this.props.roll.label||"",n=this.props.roll.fullString||"",a=this.props.roll.critString||"",r=this.props.roll.dice.map((function(t,e){return Object(J.jsx)(U,{die:t},"rollImage#".concat(e,"}"))}));return Object(J.jsxs)("div",{className:"flex-child tooltip",style:{margin:"-1px",marginBottom:"0px"},children:[r,Object(J.jsxs)("p",{children:[t,Object(J.jsxs)("span",{style:{fontSize:".75em"},children:[" ",e]})]}),Object(J.jsxs)("span",{className:"tooltiptext",children:[n,Object(J.jsx)("br",{}),a]})]})}}]),n}(r.a.Component),U=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var t="static/",e=this.props.die.kept?"dice/":"gray_dice/";return t="".concat(t).concat(e,"d").concat(this.props.die.sides,"_").concat(this.props.die.num,".svg"),Object(J.jsx)("img",{src:t,alt:"dice: ".concat(t),height:"50px"})}}]),n}(r.a.Component),q=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var t=Object.keys(this.props.aliases);return t.sort(),t=t.map((function(t,e){return Object(J.jsx)("p",{children:t},"alias#".concat(e))})),Object(J.jsxs)("div",{className:"flex-child aliases",children:[Object(J.jsx)("form",{style:{padding:"5px"},children:Object(J.jsx)("label",{className:"h2",children:"Aliases"})}),Object(J.jsx)("div",{children:t})]})}}]),n}(r.a.Component),B=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("div",{className:"flex-child log",children:[Object(J.jsxs)("label",{className:"h2",children:["Log",Object(J.jsx)("button",{className:"input",onClick:this.props.onLogClear,children:"Clear"})]}),Object(J.jsx)("div",{className:"inner-log",children:this.props.log})]})}}]),n}(r.a.Component),K=L,z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,22)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),c(t),o(t)}))};o.a.render(Object(J.jsx)(r.a.StrictMode,{children:Object(J.jsx)(K,{})}),document.getElementById("root")),z()}},[[21,1,2]]]);
//# sourceMappingURL=main.df36f5fd.chunk.js.map